{"version":3,"file":"allianz-ngx-aem-integration.mjs","sources":["../../../library/src/services/embedded-data/embedded-data-mock.service.ts","../../../library/src/constants.ts","../../../library/src/services/normalize-url/normalize-url.service.ts","../../../library/src/services/embedded-data/embedded-data.service.ts","../../../library/src/services/embedded-data/embedded-data.module.ts","../../../library/src/services/normalize-url/normalize-url.directive.ts","../../../library/src/services/normalize-url/normalize-url.pipe.ts","../../../library/src/services/normalize-url/normalize-url.module.ts","../../../library/src/allianz-ngx-aem-integration.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { ContextConfigurationBase } from './context-config-base.interface';\nimport { CustomConfigurationBase } from './custom-config-base.interface';\nimport { EmbeddedDataServiceInterface } from './embedded-data.service.model';\n\n@Injectable()\nexport class EmbeddedDataMockService<\n  CAAS_T,\n  CUSTOM_T extends CustomConfigurationBase = CustomConfigurationBase,\n  CONTEXT_T extends ContextConfigurationBase = ContextConfigurationBase,\n> implements EmbeddedDataServiceInterface<CAAS_T, CUSTOM_T, CONTEXT_T>\n{\n  public get ContextConfiguration(): CONTEXT_T {\n    return undefined;\n  }\n\n  public get CustomConfiguration(): CUSTOM_T {\n    return undefined;\n  }\n\n  public get I18n() {\n    return undefined;\n  }\n\n  public get Caas() {\n    return undefined;\n  }\n\n  public get Language(): string {\n    return undefined;\n  }\n\n  public get Country(): string {\n    return undefined;\n  }\n\n  public get LocaleId(): string {\n    return undefined;\n  }\n\n  public get InstanceId(): string {\n    return undefined;\n  }\n\n  getCaaSConfiguration(): Observable<CAAS_T> {\n    return undefined;\n  }\n}\n","export const aemIntegrationAppServerURLProperty = 'aemIntegrationAppServerURL';\n","import { Injectable, InjectionToken, Inject, Optional } from '@angular/core';\nimport { DOCUMENT } from '@angular/common';\nimport { aemIntegrationAppServerURLProperty } from '../../constants';\n\nexport const NORMALIZE_URL_SERVICE_CONFIG_TOKEN = new InjectionToken<NormalizeUrlServiceConfig>('NORMALIZE_URL_SERVICE_CONFIG_TOKEN');\n\nexport interface NormalizeUrlServiceConfig {\n  baseHref?: string;\n  deployUrl?: string;\n}\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class NormalizeUrlService {\n  private _config: NormalizeUrlServiceConfig = {\n    baseHref: '',\n    deployUrl: '',\n  };\n\n  constructor(\n    @Inject(NORMALIZE_URL_SERVICE_CONFIG_TOKEN) @Optional() private config: NormalizeUrlServiceConfig,\n    @Inject(DOCUMENT) @Optional() private document\n  ) {\n    // apply only if defined\n    if (config) {\n      if (config.baseHref) {\n        this._config.baseHref = config.baseHref;\n      }\n      if (config.deployUrl) {\n        this._config.deployUrl = config.deployUrl;\n      }\n    }\n\n    // If no deployURL was configured, check if the loader script automatically determined the deploy URL:\n    if ((!this._config || !this._config.deployUrl) && document && document[aemIntegrationAppServerURLProperty]) {\n      this._config.deployUrl = document[aemIntegrationAppServerURLProperty];\n    }\n  }\n\n  /**\n   * Taken from angular-cli/packages/@angular/cli/models/webpack-configs/styles.ts\n   *\n   * @param URL\n   */\n  normalizeUrl(URL: string): string {\n    // Is URL valid?\n    if (typeof URL !== 'string' || URL.length < 1) {\n      return '';\n    }\n\n    // Only convert root relative URLs, which CSS-Loader won't process into require().\n    if (!URL.startsWith('/') || URL.startsWith('//')) {\n      return URL;\n    }\n\n    if (this._config.deployUrl.match(/:\\/\\//)) {\n      // If deployUrl contains a scheme, ignore baseHref use deployUrl as is.\n      return `${this._config.deployUrl.replace(/\\/$/, '')}${URL}`;\n    } else if (this._config.baseHref.match(/:\\/\\//)) {\n      // If baseHref contains a scheme, include it as is.\n      return this._config.baseHref.replace(/\\/$/, '') + `/${this._config.deployUrl}/${URL}`.replace(/\\/\\/+/g, '/');\n    } else {\n      // Join together base-href, deploy-url and the original URL.\n      // Also dedupe multiple slashes into single ones.\n      return `/${this._config.baseHref}/${this._config.deployUrl}/${URL}`.replace(/\\/\\/+/g, '/');\n    }\n  }\n}\n","/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { DOCUMENT } from '@angular/common';\nimport { HttpClient } from '@angular/common/http';\nimport { Inject, Injectable, InjectionToken, Optional } from '@angular/core';\nimport { Observable, of } from 'rxjs';\nimport { concatMap } from 'rxjs/operators';\nimport { NormalizeUrlService } from '../normalize-url/normalize-url.service';\nimport { ContextConfigurationBase } from './context-config-base.interface';\nimport { CustomConfigurationBase } from './custom-config-base.interface';\nimport { EmbeddedDataServiceInterface } from './embedded-data.service.model';\n\nexport const EMBEDDED_DATA_SERVICE_CONFIG_TOKEN = new InjectionToken<EmbeddedDataServiceConfig>('EMBEDDED_DATA_SERVICE_CONFIG_TOKEN');\n\nexport interface EmbeddedDataServiceConfig {\n  /**\n   * The tag name of the root element.\n   * This is configured, as there is no way to get the element\n   * programmatically during the service initialization.\n   */\n  rootElementTagName: string;\n  production?: boolean;\n  ContextConfigurationAttribute?: string;\n  CustomConfigurationAttribute?: string;\n  DefaultCustomConfiguration?: CustomConfigurationBase;\n  I18nAttribute?: string;\n  AssetsBasePath?: string;\n  CaaSAttribute?: string;\n  LanguageDefault?: string;\n  CountryDefault?: string;\n}\n\nexport function getLocaleId(embeddedDataService: EmbeddedDataService<any, any>) {\n  return embeddedDataService.LocaleId;\n}\n\n@Injectable()\nexport class EmbeddedDataService<\n  CAAS_T,\n  CUSTOM_T extends CustomConfigurationBase = CustomConfigurationBase,\n  CONTEXT_T extends ContextConfigurationBase = ContextConfigurationBase,\n> implements EmbeddedDataServiceInterface<CAAS_T, CUSTOM_T, CONTEXT_T>\n{\n  private _rootElement: any;\n  private _documentLocale: Locale;\n\n  private _serviceConfig: EmbeddedDataServiceConfig = {\n    rootElementTagName: 'app',\n    production: true,\n    ContextConfigurationAttribute: 'contextconfiguration',\n    CustomConfigurationAttribute: 'customconfiguration',\n    I18nAttribute: 'i18n',\n    AssetsBasePath: '/assets',\n    CaaSAttribute: 'caascontent',\n    LanguageDefault: 'en',\n    CountryDefault: 'US',\n  };\n\n  public get ContextConfiguration(): CONTEXT_T {\n    if (typeof this._contextConfiguration === 'undefined') {\n      this._contextConfiguration = this.parseAttribute(this._serviceConfig.ContextConfigurationAttribute);\n    }\n    return this._contextConfiguration;\n  }\n  private _contextConfiguration: CONTEXT_T;\n\n  public get CustomConfiguration(): CUSTOM_T {\n    if (typeof this._customConfiguration === 'undefined') {\n      this._customConfiguration = Object.assign(\n        {},\n        this._serviceConfig.DefaultCustomConfiguration,\n        this.parseAttribute(this._serviceConfig.CustomConfigurationAttribute),\n      );\n    }\n    return this._customConfiguration;\n  }\n  private _customConfiguration: CUSTOM_T;\n\n  public get I18n() {\n    if (typeof this._i18n === 'undefined') {\n      this._i18n = this.parseAttribute(this._serviceConfig.I18nAttribute);\n    }\n    return this._i18n;\n  }\n  private _i18n;\n\n  public get Caas() {\n    if (typeof this._caas === 'undefined') {\n      this._caas = this.parseAttribute(this._serviceConfig.CaaSAttribute);\n    }\n    return this._caas;\n  }\n  private _caas;\n\n  public get Language(): string {\n    if (this.ContextConfiguration && this.ContextConfiguration.language) {\n      return this.ContextConfiguration.language;\n    }\n\n    return this._documentLocale && this._documentLocale.language ? this._documentLocale.language : this._serviceConfig.LanguageDefault;\n  }\n\n  public get Country(): string {\n    if (this.ContextConfiguration && this.ContextConfiguration.country) {\n      return this.ContextConfiguration.country;\n    }\n\n    return this._documentLocale && this._documentLocale.country ? this._documentLocale.country : this._serviceConfig.CountryDefault;\n  }\n\n  public get LocaleId(): string {\n    return this.Language + '-' + this.Country;\n  }\n\n  public get InstanceId(): string {\n    return this.CustomConfiguration.instanceId;\n  }\n\n  public get embeddedDataServiceConfig(): EmbeddedDataServiceConfig {\n    return this._serviceConfig;\n  }\n\n  constructor(\n    private http: HttpClient,\n    private normalizeUrlService: NormalizeUrlService,\n    @Inject(EMBEDDED_DATA_SERVICE_CONFIG_TOKEN)\n    @Optional()\n    private serviceConfig: EmbeddedDataServiceConfig,\n    @Inject(DOCUMENT) private document: any,\n  ) {\n    this.findRootElement(this.document, this.serviceConfig);\n    if (document && document.documentElement && document.documentElement.lang) {\n      this._documentLocale = parseLocale(document.documentElement.lang);\n    }\n\n    if (serviceConfig) {\n      Object.assign(this._serviceConfig, serviceConfig);\n    }\n  }\n\n  private findRootElement(_document: any, serviceConfig: EmbeddedDataServiceConfig) {\n    if (serviceConfig && serviceConfig.rootElementTagName) {\n      const nativeElement = _document.getElementsByTagName(serviceConfig.rootElementTagName);\n      if (nativeElement && nativeElement.length === 1) {\n        this._rootElement = nativeElement[0];\n        return;\n      }\n    }\n    throw new Error('EmbeddedDataService: Root element of app could not be found!');\n  }\n\n  private parseAttribute(name: string): any {\n    if (!this._rootElement) {\n      throw new Error('Embedded data was not initialized!');\n    }\n    try {\n      const attrCont = this._rootElement.getAttribute(name);\n      if (attrCont.length > 0) {\n        const content = JSON.parse(attrCont);\n        if (!isEmpty(content)) {\n          return content;\n        }\n      }\n    } catch (e) {\n      if (!this._serviceConfig.production) {\n        console.log('Error parsing embedded data point: ' + name);\n      }\n    }\n    return;\n  }\n\n  /**\n   * CaaS resolution logic:\n   *    1. If CaaS attribute was received, use that\n   *    2. If instanceId in Custom configuration, try instance config\n   *    3. try global config\n   * @param lang\n   */\n  getCaaSConfiguration(): Observable<CAAS_T> {\n    // 1.\n    if (this.Caas) {\n      return of(this.Caas);\n    }\n\n    let ret: Observable<null | CAAS_T> = of(null);\n\n    // 2.\n    if (this.CustomConfiguration.instanceId) {\n      ret = ret.pipe(\n        concatMap(() => {\n          return <Observable<CAAS_T>>(\n            this.http\n              .get(\n                this.normalizeUrlService.normalizeUrl(\n                  `${this._serviceConfig.AssetsBasePath}/${this.CustomConfiguration.instanceId}/config.json`,\n                ),\n                { withCredentials: true },\n              )\n              .pipe(() => of(null))\n          );\n        }),\n      );\n    }\n\n    // 3.\n    ret = ret.pipe(\n      concatMap((prev) => {\n        if (prev === null) {\n          return <Observable<CAAS_T>>this.http.get(\n            this.normalizeUrlService.normalizeUrl(`${this._serviceConfig.AssetsBasePath}/config.json`),\n            {\n              withCredentials: true,\n            },\n          );\n        } else {\n          return of(prev);\n        }\n      }),\n    );\n\n    return ret;\n  }\n}\n\nfunction isEmpty(obj) {\n  for (const prop in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, prop)) {\n      return false;\n    }\n  }\n  return true;\n}\n\ninterface Locale {\n  language: string;\n  variant?: string;\n  country?: string;\n  script?: string;\n  keyword: string;\n}\n\n// http://userguide.icu-project.org/locale\nfunction parseLocale(locale): Locale {\n  if (!locale) {\n    return void 0;\n  }\n\n  // extract keyword\n  const stringLocale = String(locale);\n  const keywordPos = stringLocale.indexOf('@');\n\n  const keyword = keywordPos !== -1 ? stringLocale.substr(keywordPos + 1) : void 0;\n\n  const localeWithoutKeyword = keywordPos !== -1 ? stringLocale.substr(0, keywordPos) : stringLocale;\n\n  // en-us => en_us\n  const parts = String(localeWithoutKeyword).replace(/-/g, '_').split('_');\n\n  if (!parts.length || parts.length > 4) {\n    return void 0;\n  }\n\n  const language = parts.shift();\n  if (!language) {\n    return void 0;\n  }\n\n  const retVar: Locale = {\n    keyword,\n    language: language.toLowerCase(),\n  };\n\n  if (!parts.length) {\n    return retVar;\n  }\n\n  if (parts.length === 3) {\n    const variant = parts.pop();\n    if (variant) {\n      retVar.variant = variant.toUpperCase();\n    }\n  }\n\n  let country = parts.pop();\n  if (country.length > 3) {\n    retVar.keyword = country;\n\n    country = parts.pop();\n  }\n\n  if (country) {\n    retVar.country = country.toUpperCase();\n  }\n\n  if (!parts.length) {\n    return retVar;\n  }\n\n  const script = parts.pop();\n  if (script) {\n    // capitalize it.\n    retVar.script = script.substr(0, 1).toUpperCase() + script.substr(1).toLowerCase();\n  }\n\n  return retVar;\n}\n","import { provideHttpClient, withInterceptorsFromDi } from '@angular/common/http';\nimport { ModuleWithProviders, NgModule } from '@angular/core';\nimport { EmbeddedDataMockService } from './embedded-data-mock.service';\nimport { EMBEDDED_DATA_SERVICE_CONFIG_TOKEN, EmbeddedDataService, EmbeddedDataServiceConfig } from './embedded-data.service';\n\n@NgModule({ providers: [provideHttpClient(withInterceptorsFromDi())] })\nexport class EmbeddedDataModule {\n  static forRoot(serviceConfig?: EmbeddedDataServiceConfig): ModuleWithProviders<EmbeddedDataModule> {\n    return {\n      ngModule: EmbeddedDataModule,\n      providers: [\n        { provide: EMBEDDED_DATA_SERVICE_CONFIG_TOKEN, useValue: serviceConfig }, //\n        EmbeddedDataService,\n      ],\n    };\n  }\n}\n\n@NgModule({\n  providers: [{ provide: EmbeddedDataService, useClass: EmbeddedDataMockService }],\n})\nexport class EmbeddedDataMockModule {}\n","import { Directive, ElementRef, Renderer2, Input, Inject } from '@angular/core';\nimport { NormalizeUrlService } from './normalize-url.service';\n\n@Directive({\n  // eslint-disable-next-line\n  selector: '[aemNormalizeUrl] [src]',\n})\nexport class NormalizeUrlDirective {\n  @Input()\n  public set src(val: string) {\n    this._renderer.setAttribute(this._el.nativeElement, 'src', this._normalizeUrlService.normalizeUrl(val));\n  }\n\n  constructor(\n    @Inject(ElementRef) private _el: ElementRef,\n    @Inject(Renderer2) private _renderer: Renderer2,\n    @Inject(NormalizeUrlService) private _normalizeUrlService: NormalizeUrlService\n  ) {}\n}\n","import { Pipe, PipeTransform } from '@angular/core';\nimport { NormalizeUrlService } from './normalize-url.service';\n\n@Pipe({\n  name: 'aemNormalizeUrl',\n})\nexport class NormalizeUrlPipe implements PipeTransform {\n  constructor(private normalizeUrlService: NormalizeUrlService) {}\n\n  transform(value: string): unknown {\n    return this.normalizeUrlService.normalizeUrl(value);\n  }\n}\n","import { NgModule, ModuleWithProviders, Provider } from '@angular/core';\nimport { NormalizeUrlDirective } from './normalize-url.directive';\nimport { NormalizeUrlPipe } from './normalize-url.pipe';\n\n@NgModule({\n  declarations: [NormalizeUrlDirective, NormalizeUrlPipe],\n  exports: [NormalizeUrlDirective, NormalizeUrlPipe],\n})\nexport class NormalizeUrlModule {\n  static forRoot(normalizeUrlServiceConfigProvider: Provider): ModuleWithProviders<NormalizeUrlModule> {\n    return {\n      ngModule: NormalizeUrlModule,\n      providers: [normalizeUrlServiceConfigProvider],\n    };\n  }\n}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":["i2.NormalizeUrlService","i1.NormalizeUrlService"],"mappings":";;;;;;;;MAOa,uBAAuB,CAAA;AAMlC,IAAA,IAAW,oBAAoB,GAAA;AAC7B,QAAA,OAAO,SAAS,CAAC;KAClB;AAED,IAAA,IAAW,mBAAmB,GAAA;AAC5B,QAAA,OAAO,SAAS,CAAC;KAClB;AAED,IAAA,IAAW,IAAI,GAAA;AACb,QAAA,OAAO,SAAS,CAAC;KAClB;AAED,IAAA,IAAW,IAAI,GAAA;AACb,QAAA,OAAO,SAAS,CAAC;KAClB;AAED,IAAA,IAAW,QAAQ,GAAA;AACjB,QAAA,OAAO,SAAS,CAAC;KAClB;AAED,IAAA,IAAW,OAAO,GAAA;AAChB,QAAA,OAAO,SAAS,CAAC;KAClB;AAED,IAAA,IAAW,QAAQ,GAAA;AACjB,QAAA,OAAO,SAAS,CAAC;KAClB;AAED,IAAA,IAAW,UAAU,GAAA;AACnB,QAAA,OAAO,SAAS,CAAC;KAClB;IAED,oBAAoB,GAAA;AAClB,QAAA,OAAO,SAAS,CAAC;KAClB;8GAxCU,uBAAuB,EAAA,IAAA,EAAA,EAAA,EAAA,MAAA,EAAA,EAAA,CAAA,eAAA,CAAA,UAAA,EAAA,CAAA,CAAA,EAAA;kHAAvB,uBAAuB,EAAA,CAAA,CAAA,EAAA;;2FAAvB,uBAAuB,EAAA,UAAA,EAAA,CAAA;kBADnC,UAAU;;;ACNJ,MAAM,kCAAkC,GAAG,4BAA4B;;MCIjE,kCAAkC,GAAG,IAAI,cAAc,CAA4B,oCAAoC,EAAE;MAUzH,mBAAmB,CAAA;IAM9B,WACkE,CAAA,MAAiC,EAC3D,QAAQ,EAAA;QADkB,IAAM,CAAA,MAAA,GAAN,MAAM,CAA2B;QAC3D,IAAQ,CAAA,QAAA,GAAR,QAAQ,CAAA;AAPxC,QAAA,IAAA,CAAA,OAAO,GAA8B;AAC3C,YAAA,QAAQ,EAAE,EAAE;AACZ,YAAA,SAAS,EAAE,EAAE;SACd,CAAC;;QAOA,IAAI,MAAM,EAAE;AACV,YAAA,IAAI,MAAM,CAAC,QAAQ,EAAE;gBACnB,IAAI,CAAC,OAAO,CAAC,QAAQ,GAAG,MAAM,CAAC,QAAQ,CAAC;aACzC;AACD,YAAA,IAAI,MAAM,CAAC,SAAS,EAAE;gBACpB,IAAI,CAAC,OAAO,CAAC,SAAS,GAAG,MAAM,CAAC,SAAS,CAAC;aAC3C;SACF;;QAGD,IAAI,CAAC,CAAC,IAAI,CAAC,OAAO,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,KAAK,QAAQ,IAAI,QAAQ,CAAC,kCAAkC,CAAC,EAAE;YAC1G,IAAI,CAAC,OAAO,CAAC,SAAS,GAAG,QAAQ,CAAC,kCAAkC,CAAC,CAAC;SACvE;KACF;AAED;;;;AAIG;AACH,IAAA,YAAY,CAAC,GAAW,EAAA;;QAEtB,IAAI,OAAO,GAAG,KAAK,QAAQ,IAAI,GAAG,CAAC,MAAM,GAAG,CAAC,EAAE;AAC7C,YAAA,OAAO,EAAE,CAAC;SACX;;AAGD,QAAA,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC,GAAG,CAAC,IAAI,GAAG,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE;AAChD,YAAA,OAAO,GAAG,CAAC;SACZ;QAED,IAAI,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,KAAK,CAAC,OAAO,CAAC,EAAE;;AAEzC,YAAA,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC,CAAG,EAAA,GAAG,EAAE,CAAC;SAC7D;aAAM,IAAI,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,OAAO,CAAC,EAAE;;AAE/C,YAAA,OAAO,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC,GAAG,CAAA,CAAA,EAAI,IAAI,CAAC,OAAO,CAAC,SAAS,CAAA,CAAA,EAAI,GAAG,CAAA,CAAE,CAAC,OAAO,CAAC,QAAQ,EAAE,GAAG,CAAC,CAAC;SAC9G;aAAM;;;YAGL,OAAO,CAAA,CAAA,EAAI,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAA,CAAA,EAAI,IAAI,CAAC,OAAO,CAAC,SAAS,CAAI,CAAA,EAAA,GAAG,EAAE,CAAC,OAAO,CAAC,QAAQ,EAAE,GAAG,CAAC,CAAC;SAC5F;KACF;8GArDU,mBAAmB,EAAA,IAAA,EAAA,CAAA,EAAA,KAAA,EAOpB,kCAAkC,EAAA,QAAA,EAAA,IAAA,EAAA,EAAA,EAAA,KAAA,EAClC,QAAQ,EAAA,QAAA,EAAA,IAAA,EAAA,CAAA,EAAA,MAAA,EAAA,EAAA,CAAA,eAAA,CAAA,UAAA,EAAA,CAAA,CAAA,EAAA;AARP,IAAA,SAAA,IAAA,CAAA,KAAA,GAAA,EAAA,CAAA,qBAAA,CAAA,EAAA,UAAA,EAAA,QAAA,EAAA,OAAA,EAAA,QAAA,EAAA,QAAA,EAAA,EAAA,EAAA,IAAA,EAAA,mBAAmB,cAFlB,MAAM,EAAA,CAAA,CAAA,EAAA;;2FAEP,mBAAmB,EAAA,UAAA,EAAA,CAAA;kBAH/B,UAAU;AAAC,YAAA,IAAA,EAAA,CAAA;AACV,oBAAA,UAAU,EAAE,MAAM;AACnB,iBAAA,CAAA;;0BAQI,MAAM;2BAAC,kCAAkC,CAAA;;0BAAG,QAAQ;;0BACpD,MAAM;2BAAC,QAAQ,CAAA;;0BAAG,QAAQ;;;ACtB/B;MAWa,kCAAkC,GAAG,IAAI,cAAc,CAA4B,oCAAoC,EAAE;AAoBhI,SAAU,WAAW,CAAC,mBAAkD,EAAA;IAC5E,OAAO,mBAAmB,CAAC,QAAQ,CAAC;AACtC,CAAC;MAGY,mBAAmB,CAAA;AAqB9B,IAAA,IAAW,oBAAoB,GAAA;AAC7B,QAAA,IAAI,OAAO,IAAI,CAAC,qBAAqB,KAAK,WAAW,EAAE;AACrD,YAAA,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,cAAc,CAAC,6BAA6B,CAAC,CAAC;SACrG;QACD,OAAO,IAAI,CAAC,qBAAqB,CAAC;KACnC;AAGD,IAAA,IAAW,mBAAmB,GAAA;AAC5B,QAAA,IAAI,OAAO,IAAI,CAAC,oBAAoB,KAAK,WAAW,EAAE;YACpD,IAAI,CAAC,oBAAoB,GAAG,MAAM,CAAC,MAAM,CACvC,EAAE,EACF,IAAI,CAAC,cAAc,CAAC,0BAA0B,EAC9C,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,cAAc,CAAC,4BAA4B,CAAC,CACtE,CAAC;SACH;QACD,OAAO,IAAI,CAAC,oBAAoB,CAAC;KAClC;AAGD,IAAA,IAAW,IAAI,GAAA;AACb,QAAA,IAAI,OAAO,IAAI,CAAC,KAAK,KAAK,WAAW,EAAE;AACrC,YAAA,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC,CAAC;SACrE;QACD,OAAO,IAAI,CAAC,KAAK,CAAC;KACnB;AAGD,IAAA,IAAW,IAAI,GAAA;AACb,QAAA,IAAI,OAAO,IAAI,CAAC,KAAK,KAAK,WAAW,EAAE;AACrC,YAAA,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC,CAAC;SACrE;QACD,OAAO,IAAI,CAAC,KAAK,CAAC;KACnB;AAGD,IAAA,IAAW,QAAQ,GAAA;QACjB,IAAI,IAAI,CAAC,oBAAoB,IAAI,IAAI,CAAC,oBAAoB,CAAC,QAAQ,EAAE;AACnE,YAAA,OAAO,IAAI,CAAC,oBAAoB,CAAC,QAAQ,CAAC;SAC3C;QAED,OAAO,IAAI,CAAC,eAAe,IAAI,IAAI,CAAC,eAAe,CAAC,QAAQ,GAAG,IAAI,CAAC,eAAe,CAAC,QAAQ,GAAG,IAAI,CAAC,cAAc,CAAC,eAAe,CAAC;KACpI;AAED,IAAA,IAAW,OAAO,GAAA;QAChB,IAAI,IAAI,CAAC,oBAAoB,IAAI,IAAI,CAAC,oBAAoB,CAAC,OAAO,EAAE;AAClE,YAAA,OAAO,IAAI,CAAC,oBAAoB,CAAC,OAAO,CAAC;SAC1C;QAED,OAAO,IAAI,CAAC,eAAe,IAAI,IAAI,CAAC,eAAe,CAAC,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,OAAO,GAAG,IAAI,CAAC,cAAc,CAAC,cAAc,CAAC;KACjI;AAED,IAAA,IAAW,QAAQ,GAAA;QACjB,OAAO,IAAI,CAAC,QAAQ,GAAG,GAAG,GAAG,IAAI,CAAC,OAAO,CAAC;KAC3C;AAED,IAAA,IAAW,UAAU,GAAA;AACnB,QAAA,OAAO,IAAI,CAAC,mBAAmB,CAAC,UAAU,CAAC;KAC5C;AAED,IAAA,IAAW,yBAAyB,GAAA;QAClC,OAAO,IAAI,CAAC,cAAc,CAAC;KAC5B;AAED,IAAA,WAAA,CACU,IAAgB,EAChB,mBAAwC,EAGxC,aAAwC,EACtB,QAAa,EAAA;QAL/B,IAAI,CAAA,IAAA,GAAJ,IAAI,CAAY;QAChB,IAAmB,CAAA,mBAAA,GAAnB,mBAAmB,CAAqB;QAGxC,IAAa,CAAA,aAAA,GAAb,aAAa,CAA2B;QACtB,IAAQ,CAAA,QAAA,GAAR,QAAQ,CAAK;AAlFjC,QAAA,IAAA,CAAA,cAAc,GAA8B;AAClD,YAAA,kBAAkB,EAAE,KAAK;AACzB,YAAA,UAAU,EAAE,IAAI;AAChB,YAAA,6BAA6B,EAAE,sBAAsB;AACrD,YAAA,4BAA4B,EAAE,qBAAqB;AACnD,YAAA,aAAa,EAAE,MAAM;AACrB,YAAA,cAAc,EAAE,SAAS;AACzB,YAAA,aAAa,EAAE,aAAa;AAC5B,YAAA,eAAe,EAAE,IAAI;AACrB,YAAA,cAAc,EAAE,IAAI;SACrB,CAAC;QA0EA,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC;AACxD,QAAA,IAAI,QAAQ,IAAI,QAAQ,CAAC,eAAe,IAAI,QAAQ,CAAC,eAAe,CAAC,IAAI,EAAE;YACzE,IAAI,CAAC,eAAe,GAAG,WAAW,CAAC,QAAQ,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;SACnE;QAED,IAAI,aAAa,EAAE;YACjB,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,cAAc,EAAE,aAAa,CAAC,CAAC;SACnD;KACF;IAEO,eAAe,CAAC,SAAc,EAAE,aAAwC,EAAA;AAC9E,QAAA,IAAI,aAAa,IAAI,aAAa,CAAC,kBAAkB,EAAE;YACrD,MAAM,aAAa,GAAG,SAAS,CAAC,oBAAoB,CAAC,aAAa,CAAC,kBAAkB,CAAC,CAAC;YACvF,IAAI,aAAa,IAAI,aAAa,CAAC,MAAM,KAAK,CAAC,EAAE;AAC/C,gBAAA,IAAI,CAAC,YAAY,GAAG,aAAa,CAAC,CAAC,CAAC,CAAC;gBACrC,OAAO;aACR;SACF;AACD,QAAA,MAAM,IAAI,KAAK,CAAC,8DAA8D,CAAC,CAAC;KACjF;AAEO,IAAA,cAAc,CAAC,IAAY,EAAA;AACjC,QAAA,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE;AACtB,YAAA,MAAM,IAAI,KAAK,CAAC,oCAAoC,CAAC,CAAC;SACvD;AACD,QAAA,IAAI;YACF,MAAM,QAAQ,GAAG,IAAI,CAAC,YAAY,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC;AACtD,YAAA,IAAI,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE;gBACvB,MAAM,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;AACrC,gBAAA,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE;AACrB,oBAAA,OAAO,OAAO,CAAC;iBAChB;aACF;SACF;QAAC,OAAO,CAAC,EAAE;AACV,YAAA,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,UAAU,EAAE;AACnC,gBAAA,OAAO,CAAC,GAAG,CAAC,qCAAqC,GAAG,IAAI,CAAC,CAAC;aAC3D;SACF;QACD,OAAO;KACR;AAED;;;;;;AAMG;IACH,oBAAoB,GAAA;;AAElB,QAAA,IAAI,IAAI,CAAC,IAAI,EAAE;AACb,YAAA,OAAO,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SACtB;AAED,QAAA,IAAI,GAAG,GAA8B,EAAE,CAAC,IAAI,CAAC,CAAC;;AAG9C,QAAA,IAAI,IAAI,CAAC,mBAAmB,CAAC,UAAU,EAAE;YACvC,GAAG,GAAG,GAAG,CAAC,IAAI,CACZ,SAAS,CAAC,MAAK;gBACb,QACE,IAAI,CAAC,IAAI;qBACN,GAAG,CACF,IAAI,CAAC,mBAAmB,CAAC,YAAY,CACnC,CAAG,EAAA,IAAI,CAAC,cAAc,CAAC,cAAc,CAAI,CAAA,EAAA,IAAI,CAAC,mBAAmB,CAAC,UAAU,CAAc,YAAA,CAAA,CAC3F,EACD,EAAE,eAAe,EAAE,IAAI,EAAE,CAC1B;qBACA,IAAI,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC,CAAC,EACvB;aACH,CAAC,CACH,CAAC;SACH;;QAGD,GAAG,GAAG,GAAG,CAAC,IAAI,CACZ,SAAS,CAAC,CAAC,IAAI,KAAI;AACjB,YAAA,IAAI,IAAI,KAAK,IAAI,EAAE;gBACjB,OAA2B,IAAI,CAAC,IAAI,CAAC,GAAG,CACtC,IAAI,CAAC,mBAAmB,CAAC,YAAY,CAAC,CAAA,EAAG,IAAI,CAAC,cAAc,CAAC,cAAc,CAAA,YAAA,CAAc,CAAC,EAC1F;AACE,oBAAA,eAAe,EAAE,IAAI;AACtB,iBAAA,CACF,CAAC;aACH;iBAAM;AACL,gBAAA,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;aACjB;SACF,CAAC,CACH,CAAC;AAEF,QAAA,OAAO,GAAG,CAAC;KACZ;8GAxLU,mBAAmB,EAAA,IAAA,EAAA,CAAA,EAAA,KAAA,EAAA,EAAA,CAAA,UAAA,EAAA,EAAA,EAAA,KAAA,EAAAA,mBAAA,EAAA,EAAA,EAAA,KAAA,EAwFpB,kCAAkC,EAAA,QAAA,EAAA,IAAA,EAAA,EAAA,EAAA,KAAA,EAGlC,QAAQ,EAAA,CAAA,EAAA,MAAA,EAAA,EAAA,CAAA,eAAA,CAAA,UAAA,EAAA,CAAA,CAAA,EAAA;kHA3FP,mBAAmB,EAAA,CAAA,CAAA,EAAA;;2FAAnB,mBAAmB,EAAA,UAAA,EAAA,CAAA;kBAD/B,UAAU;;0BAyFN,MAAM;2BAAC,kCAAkC,CAAA;;0BACzC,QAAQ;;0BAER,MAAM;2BAAC,QAAQ,CAAA;;AAgGpB,SAAS,OAAO,CAAC,GAAG,EAAA;AAClB,IAAA,KAAK,MAAM,IAAI,IAAI,GAAG,EAAE;AACtB,QAAA,IAAI,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,GAAG,EAAE,IAAI,CAAC,EAAE;AACnD,YAAA,OAAO,KAAK,CAAC;SACd;KACF;AACD,IAAA,OAAO,IAAI,CAAC;AACd,CAAC;AAUD;AACA,SAAS,WAAW,CAAC,MAAM,EAAA;IACzB,IAAI,CAAC,MAAM,EAAE;QACX,OAAO,KAAK,CAAC,CAAC;KACf;;AAGD,IAAA,MAAM,YAAY,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC;IACpC,MAAM,UAAU,GAAG,YAAY,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;IAE7C,MAAM,OAAO,GAAG,UAAU,KAAK,CAAC,CAAC,GAAG,YAAY,CAAC,MAAM,CAAC,UAAU,GAAG,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC;IAEjF,MAAM,oBAAoB,GAAG,UAAU,KAAK,CAAC,CAAC,GAAG,YAAY,CAAC,MAAM,CAAC,CAAC,EAAE,UAAU,CAAC,GAAG,YAAY,CAAC;;AAGnG,IAAA,MAAM,KAAK,GAAG,MAAM,CAAC,oBAAoB,CAAC,CAAC,OAAO,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IAEzE,IAAI,CAAC,KAAK,CAAC,MAAM,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;QACrC,OAAO,KAAK,CAAC,CAAC;KACf;AAED,IAAA,MAAM,QAAQ,GAAG,KAAK,CAAC,KAAK,EAAE,CAAC;IAC/B,IAAI,CAAC,QAAQ,EAAE;QACb,OAAO,KAAK,CAAC,CAAC;KACf;AAED,IAAA,MAAM,MAAM,GAAW;QACrB,OAAO;AACP,QAAA,QAAQ,EAAE,QAAQ,CAAC,WAAW,EAAE;KACjC,CAAC;AAEF,IAAA,IAAI,CAAC,KAAK,CAAC,MAAM,EAAE;AACjB,QAAA,OAAO,MAAM,CAAC;KACf;AAED,IAAA,IAAI,KAAK,CAAC,MAAM,KAAK,CAAC,EAAE;AACtB,QAAA,MAAM,OAAO,GAAG,KAAK,CAAC,GAAG,EAAE,CAAC;QAC5B,IAAI,OAAO,EAAE;AACX,YAAA,MAAM,CAAC,OAAO,GAAG,OAAO,CAAC,WAAW,EAAE,CAAC;SACxC;KACF;AAED,IAAA,IAAI,OAAO,GAAG,KAAK,CAAC,GAAG,EAAE,CAAC;AAC1B,IAAA,IAAI,OAAO,CAAC,MAAM,GAAG,CAAC,EAAE;AACtB,QAAA,MAAM,CAAC,OAAO,GAAG,OAAO,CAAC;AAEzB,QAAA,OAAO,GAAG,KAAK,CAAC,GAAG,EAAE,CAAC;KACvB;IAED,IAAI,OAAO,EAAE;AACX,QAAA,MAAM,CAAC,OAAO,GAAG,OAAO,CAAC,WAAW,EAAE,CAAC;KACxC;AAED,IAAA,IAAI,CAAC,KAAK,CAAC,MAAM,EAAE;AACjB,QAAA,OAAO,MAAM,CAAC;KACf;AAED,IAAA,MAAM,MAAM,GAAG,KAAK,CAAC,GAAG,EAAE,CAAC;IAC3B,IAAI,MAAM,EAAE;;QAEV,MAAM,CAAC,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,WAAW,EAAE,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,CAAC;KACpF;AAED,IAAA,OAAO,MAAM,CAAC;AAChB;;MC1Sa,kBAAkB,CAAA;IAC7B,OAAO,OAAO,CAAC,aAAyC,EAAA;QACtD,OAAO;AACL,YAAA,QAAQ,EAAE,kBAAkB;AAC5B,YAAA,SAAS,EAAE;gBACT,EAAE,OAAO,EAAE,kCAAkC,EAAE,QAAQ,EAAE,aAAa,EAAE;gBACxE,mBAAmB;AACpB,aAAA;SACF,CAAC;KACH;8GATU,kBAAkB,EAAA,IAAA,EAAA,EAAA,EAAA,MAAA,EAAA,EAAA,CAAA,eAAA,CAAA,QAAA,EAAA,CAAA,CAAA,EAAA;+GAAlB,kBAAkB,EAAA,CAAA,CAAA,EAAA;AAAlB,IAAA,SAAA,IAAA,CAAA,IAAA,GAAA,EAAA,CAAA,mBAAA,CAAA,EAAA,UAAA,EAAA,QAAA,EAAA,OAAA,EAAA,QAAA,EAAA,QAAA,EAAA,EAAA,EAAA,IAAA,EAAA,kBAAkB,aADR,CAAC,iBAAiB,CAAC,sBAAsB,EAAE,CAAC,CAAC,EAAA,CAAA,CAAA,EAAA;;2FACvD,kBAAkB,EAAA,UAAA,EAAA,CAAA;kBAD9B,QAAQ;mBAAC,EAAE,SAAS,EAAE,CAAC,iBAAiB,CAAC,sBAAsB,EAAE,CAAC,CAAC,EAAE,CAAA;;MAgBzD,sBAAsB,CAAA;8GAAtB,sBAAsB,EAAA,IAAA,EAAA,EAAA,EAAA,MAAA,EAAA,EAAA,CAAA,eAAA,CAAA,QAAA,EAAA,CAAA,CAAA,EAAA;+GAAtB,sBAAsB,EAAA,CAAA,CAAA,EAAA;+GAAtB,sBAAsB,EAAA,SAAA,EAFtB,CAAC,EAAE,OAAO,EAAE,mBAAmB,EAAE,QAAQ,EAAE,uBAAuB,EAAE,CAAC,EAAA,CAAA,CAAA,EAAA;;2FAErE,sBAAsB,EAAA,UAAA,EAAA,CAAA;kBAHlC,QAAQ;AAAC,YAAA,IAAA,EAAA,CAAA;oBACR,SAAS,EAAE,CAAC,EAAE,OAAO,EAAE,mBAAmB,EAAE,QAAQ,EAAE,uBAAuB,EAAE,CAAC;AACjF,iBAAA,CAAA;;;MCbY,qBAAqB,CAAA;IAChC,IACW,GAAG,CAAC,GAAW,EAAA;QACxB,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,IAAI,CAAC,GAAG,CAAC,aAAa,EAAE,KAAK,EAAE,IAAI,CAAC,oBAAoB,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC,CAAC;KACzG;AAED,IAAA,WAAA,CAC8B,GAAe,EAChB,SAAoB,EACV,oBAAyC,EAAA;QAFlD,IAAG,CAAA,GAAA,GAAH,GAAG,CAAY;QAChB,IAAS,CAAA,SAAA,GAAT,SAAS,CAAW;QACV,IAAoB,CAAA,oBAAA,GAApB,oBAAoB,CAAqB;KAC5E;AAVO,IAAA,SAAA,IAAA,CAAA,IAAA,GAAA,EAAA,CAAA,kBAAA,CAAA,EAAA,UAAA,EAAA,QAAA,EAAA,OAAA,EAAA,QAAA,EAAA,QAAA,EAAA,EAAA,EAAA,IAAA,EAAA,qBAAqB,EAOtB,IAAA,EAAA,CAAA,EAAA,KAAA,EAAA,UAAU,EACV,EAAA,EAAA,KAAA,EAAA,SAAS,aACT,mBAAmB,EAAA,CAAA,EAAA,MAAA,EAAA,EAAA,CAAA,eAAA,CAAA,SAAA,EAAA,CAAA,CAAA,EAAA;kGATlB,qBAAqB,EAAA,QAAA,EAAA,yBAAA,EAAA,MAAA,EAAA,EAAA,GAAA,EAAA,KAAA,EAAA,EAAA,QAAA,EAAA,EAAA,EAAA,CAAA,CAAA,EAAA;;2FAArB,qBAAqB,EAAA,UAAA,EAAA,CAAA;kBAJjC,SAAS;AAAC,YAAA,IAAA,EAAA,CAAA;;AAET,oBAAA,QAAQ,EAAE,yBAAyB;AACpC,iBAAA,CAAA;;0BAQI,MAAM;2BAAC,UAAU,CAAA;;0BACjB,MAAM;2BAAC,SAAS,CAAA;;0BAChB,MAAM;2BAAC,mBAAmB,CAAA;yCAPlB,GAAG,EAAA,CAAA;sBADb,KAAK;;;MCFK,gBAAgB,CAAA;AAC3B,IAAA,WAAA,CAAoB,mBAAwC,EAAA;QAAxC,IAAmB,CAAA,mBAAA,GAAnB,mBAAmB,CAAqB;KAAI;AAEhE,IAAA,SAAS,CAAC,KAAa,EAAA;QACrB,OAAO,IAAI,CAAC,mBAAmB,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;KACrD;8GALU,gBAAgB,EAAA,IAAA,EAAA,CAAA,EAAA,KAAA,EAAAC,mBAAA,EAAA,CAAA,EAAA,MAAA,EAAA,EAAA,CAAA,eAAA,CAAA,IAAA,EAAA,CAAA,CAAA,EAAA;4GAAhB,gBAAgB,EAAA,IAAA,EAAA,iBAAA,EAAA,CAAA,CAAA,EAAA;;2FAAhB,gBAAgB,EAAA,UAAA,EAAA,CAAA;kBAH5B,IAAI;AAAC,YAAA,IAAA,EAAA,CAAA;AACJ,oBAAA,IAAI,EAAE,iBAAiB;AACxB,iBAAA,CAAA;;;MCGY,kBAAkB,CAAA;IAC7B,OAAO,OAAO,CAAC,iCAA2C,EAAA;QACxD,OAAO;AACL,YAAA,QAAQ,EAAE,kBAAkB;YAC5B,SAAS,EAAE,CAAC,iCAAiC,CAAC;SAC/C,CAAC;KACH;8GANU,kBAAkB,EAAA,IAAA,EAAA,EAAA,EAAA,MAAA,EAAA,EAAA,CAAA,eAAA,CAAA,QAAA,EAAA,CAAA,CAAA,EAAA;AAAlB,IAAA,SAAA,IAAA,CAAA,IAAA,GAAA,EAAA,CAAA,mBAAA,CAAA,EAAA,UAAA,EAAA,QAAA,EAAA,OAAA,EAAA,QAAA,EAAA,QAAA,EAAA,EAAA,EAAA,IAAA,EAAA,kBAAkB,iBAHd,qBAAqB,EAAE,gBAAgB,CAC5C,EAAA,OAAA,EAAA,CAAA,qBAAqB,EAAE,gBAAgB,CAAA,EAAA,CAAA,CAAA,EAAA;+GAEtC,kBAAkB,EAAA,CAAA,CAAA,EAAA;;2FAAlB,kBAAkB,EAAA,UAAA,EAAA,CAAA;kBAJ9B,QAAQ;AAAC,YAAA,IAAA,EAAA,CAAA;AACR,oBAAA,YAAY,EAAE,CAAC,qBAAqB,EAAE,gBAAgB,CAAC;AACvD,oBAAA,OAAO,EAAE,CAAC,qBAAqB,EAAE,gBAAgB,CAAC;AACnD,iBAAA,CAAA;;;ACPD;;AAEG;;;;"}